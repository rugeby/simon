{"ast":null,"code":"import _regeneratorRuntime from\"/Users/liruge/Desktop/simon/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/liruge/Desktop/simon/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/liruge/Desktop/simon/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState}from'react';import Button from'react-bootstrap/Button';import{MessageDialog}from'./messageDialog';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export function Unauthenticated(props){var _useState=useState(props.userName),_useState2=_slicedToArray(_useState,2),userName=_useState2[0],setUserName=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),displayError=_useState6[0],setDisplayError=_useState6[1];function loginUser(){return _loginUser.apply(this,arguments);}function _loginUser(){_loginUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:loginOrCreate(\"/api/auth/login\");case 1:case\"end\":return _context.stop();}}},_callee);}));return _loginUser.apply(this,arguments);}function createUser(){return _createUser.apply(this,arguments);}function _createUser(){_createUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:loginOrCreate(\"/api/auth/create\");case 1:case\"end\":return _context2.stop();}}},_callee2);}));return _createUser.apply(this,arguments);}function loginOrCreate(_x){return _loginOrCreate.apply(this,arguments);}function _loginOrCreate(){_loginOrCreate=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(endpoint){var response,body;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetch(endpoint,{method:'post',body:JSON.stringify({email:userName,password:password}),headers:{'Content-type':'application/json; charset=UTF-8'}});case 2:response=_context3.sent;if(!((response===null||response===void 0?void 0:response.status)===200)){_context3.next=8;break;}localStorage.setItem('userName',userName);props.onLogin(userName);_context3.next=12;break;case 8:_context3.next=10;return response.json();case 10:body=_context3.sent;setDisplayError(\"\\u26A0 Error: \".concat(body.msg));case 12:case\"end\":return _context3.stop();}}},_callee3);}));return _loginOrCreate.apply(this,arguments);}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text\",children:\"@\"}),/*#__PURE__*/_jsx(\"input\",{className:\"form-control\",type:\"text\",value:userName,onChange:function onChange(e){return setUserName(e.target.value);},placeholder:\"your@email.com\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text\",children:\"\\uD83D\\uDD12\"}),/*#__PURE__*/_jsx(\"input\",{className:\"form-control\",type:\"password\",onChange:function onChange(e){return setPassword(e.target.value);},placeholder:\"password\"})]}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:function onClick(){return loginUser();},children:\"Login\"}),/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:function onClick(){return createUser();},children:\"Create\"})]}),/*#__PURE__*/_jsx(MessageDialog,{message:displayError,onHide:function onHide(){return setDisplayError(null);}})]});}","map":{"version":3,"names":["useState","Button","MessageDialog","Unauthenticated","props","userName","setUserName","password","setPassword","displayError","setDisplayError","loginUser","loginOrCreate","createUser","endpoint","fetch","method","body","JSON","stringify","email","headers","response","status","localStorage","setItem","onLogin","json","msg","e","target","value"],"sources":["/Users/liruge/Desktop/simon/src/login/Unauthenticated.jsx"],"sourcesContent":["import { useState } from 'react';\n\nimport Button from 'react-bootstrap/Button';\nimport { MessageDialog } from './messageDialog';\n\nexport function Unauthenticated(props) {\n  const [userName, setUserName] = useState(props.userName);\n  const [password, setPassword] = useState('');\n  const [displayError, setDisplayError] = useState(null);\n\n  async function loginUser() {\n    loginOrCreate(`/api/auth/login`);\n  }\n\n  async function createUser() {\n    loginOrCreate(`/api/auth/create`);\n  }\n\n  async function loginOrCreate(endpoint) {\n    const response = await fetch(endpoint, {\n      method: 'post',\n      body: JSON.stringify({ email: userName, password: password }),\n      headers: {\n        'Content-type': 'application/json; charset=UTF-8',\n      },\n    });\n    if (response?.status === 200) {\n      localStorage.setItem('userName', userName);\n      props.onLogin(userName);\n    } else {\n      const body = await response.json();\n      setDisplayError(`âš  Error: ${body.msg}`);\n    }\n  }\n\n  return (\n    <>\n      <div>\n        <div className='input-group mb-3'>\n          <span className='input-group-text'>@</span>\n          <input\n            className='form-control'\n            type='text'\n            value={userName}\n            onChange={(e) => setUserName(e.target.value)}\n            placeholder='your@email.com'\n          />\n        </div>\n        <div className='input-group mb-3'>\n          <span className='input-group-text'>ðŸ”’</span>\n          <input\n            className='form-control'\n            type='password'\n            onChange={(e) => setPassword(e.target.value)}\n            placeholder='password'\n          />\n        </div>\n        <Button variant='primary' onClick={() => loginUser()}>\n          Login\n        </Button>\n        <Button variant='secondary' onClick={() => createUser()}>\n          Create\n        </Button>\n      </div>\n\n      <MessageDialog message={displayError} onHide={() => setDisplayError(null)} />\n    </>\n  );\n}\n"],"mappings":"mWAAA,OAASA,QAAQ,KAAQ,OAAO,CAEhC,MAAOC,OAAM,KAAM,wBAAwB,CAC3C,OAASC,aAAa,KAAQ,iBAAiB,CAAC,6IAEhD,MAAO,SAASC,gBAAe,CAACC,KAAK,CAAE,CACrC,cAAgCJ,QAAQ,CAACI,KAAK,CAACC,QAAQ,CAAC,wCAAjDA,QAAQ,eAAEC,WAAW,eAC5B,eAAgCN,QAAQ,CAAC,EAAE,CAAC,yCAArCO,QAAQ,eAAEC,WAAW,eAC5B,eAAwCR,QAAQ,CAAC,IAAI,CAAC,yCAA/CS,YAAY,eAAEC,eAAe,eAAmB,QAExCC,UAAS,uIAAxB,qIACEC,aAAa,mBAAmB,CAAC,sDAClC,oDAEcC,WAAU,0IAAzB,0IACED,aAAa,oBAAoB,CAAC,wDACnC,qDAEcA,cAAa,qJAA5B,kBAA6BE,QAAQ,iKACZC,MAAK,CAACD,QAAQ,CAAE,CACrCE,MAAM,CAAE,MAAM,CACdC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CAAEC,KAAK,CAAEf,QAAQ,CAAEE,QAAQ,CAAEA,QAAS,CAAC,CAAC,CAC7Dc,OAAO,CAAE,CACP,cAAc,CAAE,iCAClB,CACF,CAAC,CAAC,QANIC,QAAQ,qBAOV,CAAAA,QAAQ,SAARA,QAAQ,iBAARA,QAAQ,CAAEC,MAAM,IAAK,GAAG,2BAC1BC,YAAY,CAACC,OAAO,CAAC,UAAU,CAAEpB,QAAQ,CAAC,CAC1CD,KAAK,CAACsB,OAAO,CAACrB,QAAQ,CAAC,CAAC,uDAELiB,SAAQ,CAACK,IAAI,EAAE,SAA5BV,IAAI,gBACVP,eAAe,yBAAaO,IAAI,CAACW,GAAG,EAAG,CAAC,yDAE3C,gDAED,mBACE,wCACE,oCACE,aAAK,SAAS,CAAC,kBAAkB,wBAC/B,aAAM,SAAS,CAAC,kBAAkB,eAAS,cAC3C,cACE,SAAS,CAAC,cAAc,CACxB,IAAI,CAAC,MAAM,CACX,KAAK,CAAEvB,QAAS,CAChB,QAAQ,CAAE,kBAACwB,CAAC,QAAKvB,YAAW,CAACuB,CAAC,CAACC,MAAM,CAACC,KAAK,CAAC,EAAC,CAC7C,WAAW,CAAC,gBAAgB,EAC5B,GACE,cACN,aAAK,SAAS,CAAC,kBAAkB,wBAC/B,aAAM,SAAS,CAAC,kBAAkB,0BAAU,cAC5C,cACE,SAAS,CAAC,cAAc,CACxB,IAAI,CAAC,UAAU,CACf,QAAQ,CAAE,kBAACF,CAAC,QAAKrB,YAAW,CAACqB,CAAC,CAACC,MAAM,CAACC,KAAK,CAAC,EAAC,CAC7C,WAAW,CAAC,UAAU,EACtB,GACE,cACN,KAAC,MAAM,EAAC,OAAO,CAAC,SAAS,CAAC,OAAO,CAAE,yBAAMpB,UAAS,EAAE,EAAC,mBAE5C,cACT,KAAC,MAAM,EAAC,OAAO,CAAC,WAAW,CAAC,OAAO,CAAE,yBAAME,WAAU,EAAE,EAAC,oBAE/C,GACL,cAEN,KAAC,aAAa,EAAC,OAAO,CAAEJ,YAAa,CAAC,MAAM,CAAE,wBAAMC,gBAAe,CAAC,IAAI,CAAC,EAAC,EAAG,GAC5E,CAEP"},"metadata":{},"sourceType":"module","externalDependencies":[]}